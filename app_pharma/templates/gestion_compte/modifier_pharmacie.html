{% extends 'navigateur/base.html' %}
{% load static %}

{% block title %}Modifier la pharmacie{% endblock %}

{% block pharmacie %}

<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-7">

      <!-- Logo -->
      <div class="text-center mb-4">
        <a href="#">
          <img src="{% static 'assets/images/logo-dark.svg' %}" alt="Logo" style="max-width:140px;">
        </a>
      </div>

      <!-- Card -->
      <div class="card shadow-sm border-0">
        <div class="card-body p-4">

          <h3 class="mb-2 text-center"><b>Modifier votre pharmacie</b></h3>
          <p class="text-muted text-center mb-4">
            Mettez √† jour les informations de votre √©tablissement
          </p>

          <!-- Messages Django -->
          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }}">
                {{ message }}
              </div>
            {% endfor %}
          {% endif %}

          <!-- Formulaire -->
          <form method="POST" enctype="multipart/form-data" novalidate>
            {% csrf_token %}

            <!-- ================= INFORMATIONS G√âN√âRALES ================= -->
            <h6 class="text-primary mb-3">Informations g√©n√©rales</h6>

            <div class="mb-3">
              <label class="form-label">Nom commercial *</label>
              <input type="text" name="nom_commercial" class="form-control" value="{{ pharmacie.nom_commercial }}" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Slogan</label>
              <input type="text" name="slogan" class="form-control" value="{{ pharmacie.slogan }}">
            </div>

            <div class="mb-3">
              <label class="form-label">Logo</label>
              {% if pharmacie.logo %}
                <div class="mb-2">
                  <img src="{{ pharmacie.logo.url }}" alt="Logo" style="max-height: 80px;">
                </div>
              {% endif %}
              <input type="file" name="logo" class="form-control">
            </div>

            <!-- ================= LOCALISATION ================= -->
            <hr>
            <h6 class="text-primary mb-3">Localisation</h6>

            <div class="mb-3">
              <label class="form-label">Adresse *</label>
              <textarea name="adresse" class="form-control" rows="2" required>{{ pharmacie.adresse }}</textarea>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">Ville *</label>
                <input type="text" name="ville" class="form-control" value="{{ pharmacie.ville }}" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">R√©gion</label>
                <input type="text" name="region" class="form-control" value="{{ pharmacie.region }}">
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Pays</label>
              <input type="text" name="pays" class="form-control" value="{{ pharmacie.pays }}">
            </div>

            <div class="mb-3">
              <label class="form-label">Code postal</label>
              <input type="text" name="code_postal" class="form-control" value="{{ pharmacie.code_postal }}">
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">Latitude</label>
                <input type="text" name="latitude" class="form-control" value="{{ pharmacie.latitude }}">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Longitude</label>
                <input type="text" name="longitude" class="form-control" value="{{ pharmacie.longitude }}">
              </div>
            </div>

            <!-- ================= CONTACT ================= -->
            <hr>
            <h6 class="text-primary mb-3">Contacts</h6>

            <div class="mb-3">
              <label class="form-label">T√©l√©phone principal *</label>
              <input type="text" name="telephone_principal" class="form-control" value="{{ pharmacie.telephone_principal }}" required>
            </div>

            <div class="mb-3">
              <label class="form-label">T√©l√©phone secondaire</label>
              <input type="text" name="telephone_secondaire" class="form-control" value="{{ pharmacie.telephone_secondaire }}">
            </div>

            <div class="mb-3">
              <label class="form-label">Email *</label>
              <input type="email" name="email" class="form-control" value="{{ pharmacie.email }}" required>
            </div>

            <div class="mb-3">
              <label class="form-label">WhatsApp</label>
              <input type="text" name="whatsapp" class="form-control" value="{{ pharmacie.whatsapp }}">
            </div>

            <div class="mb-3">
              <label class="form-label">Site web</label>
              <input type="url" name="site_web" class="form-control" value="{{ pharmacie.site_web }}">
            </div>

            <!-- ================= INFORMATIONS L√âGALES ================= -->
            <hr>
            <h6 class="text-primary mb-3">Informations l√©gales</h6>

            <div class="mb-3">
              <label class="form-label">Num√©ro d‚Äôautorisation *</label>
              <input type="text" name="numero_autorisation" class="form-control" value="{{ pharmacie.numero_autorisation }}" required>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">NIF</label>
                <input type="text" name="nif" class="form-control" value="{{ pharmacie.nif }}">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">RCCM</label>
                <input type="text" name="rccm" class="form-control" value="{{ pharmacie.rccm }}">
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">Date d‚Äôautorisation</label>
                <input type="date" name="date_autorisation" class="form-control" value="{{ pharmacie.date_autorisation|date:'Y-m-d' }}">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date d‚Äôexpiration</label>
                <input type="date" name="date_expiration_autorisation" class="form-control" value="{{ pharmacie.date_expiration_autorisation|date:'Y-m-d' }}">
              </div>
            </div>

            <!-- ================= PARAM√àTRES ================= -->
            <hr>
            <h6 class="text-primary mb-3">Param√®tres</h6>

            <div class="mb-3">
              <label class="form-label">Devise</label>
              <input type="text" name="devise" class="form-control" value="{{ pharmacie.devise }}">
            </div>

            <div class="mb-3">
              <label class="form-label">Symbole de la devise</label>
              <input type="text" name="symbole_devise" class="form-control" value="{{ pharmacie.symbole_devise }}">
            </div>

            <div class="mb-3">
              <label class="form-label">Taux TVA</label>
              <input type="number" step="0.01" name="taux_tva" class="form-control" value="{{ pharmacie.taux_tva }}">
            </div>

            <div class="mb-3">
              <label class="form-label">Fuseau horaire</label>
              <input type="text" name="fuseau_horaire" class="form-control" value="{{ pharmacie.fuseau_horaire }}">
            </div>

            <div class="mb-3">
              <label class="form-label">Statut</label>
              <select name="statut" class="form-control">
                <option value="active" {% if pharmacie.statut == 'active' %}selected{% endif %}>Active</option>
                <option value="suspendue" {% if pharmacie.statut == 'suspendue' %}selected{% endif %}>Suspendue</option>
                <option value="fermee" {% if pharmacie.statut == 'fermee' %}selected{% endif %}>Ferm√©e</option>
              </select>
            </div>

            <!-- ================= ACTION ================= -->
            <div class="d-grid mt-4">
              <button type="submit" class="btn btn-primary btn-lg">
                üíæ Enregistrer les modifications
              </button>
            </div>

            <p class="text-muted text-center small mt-3">
              Vous pourrez compl√©ter les param√®tres avanc√©s plus tard.
            </p>

          </form>

        </div>
      </div>

      <!-- Footer -->
      <div class="text-center mt-4">
        <p class="m-0">¬© {{ now|date:"Y" }} ‚Äì Tous droits r√©serv√©s</p>
      </div>

    </div>
  </div>
</div>

{% endblock %}